<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iris Flower Prediction</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <h1>üå∏ Iris Flower Prediction</h1>
        <p class="subtitle">Enter the measurements to identify the Iris species</p>
        
        <div class="form-container">
            <form action="/predict" method="post">
                <div class="input-row">
                    {% for html_name, display_name in fields[:2] %}
                    <div class="input-group">
                        <label for="{{ html_name }}">{{ display_name }}</label>
                        <input type="text" 
                               id="{{ html_name }}" 
                               name="{{ html_name }}" 
                               value="{{ request.form.get(html_name, '') }}"
                               placeholder="Enter value in cm"
                               required>
                        <p class="hint-text">Range: {{ '{:.1f}'.format(ranges[html_name][0]) }} - {{ '{:.1f}'.format(ranges[html_name][1]) }} cm</p>
                    </div>
                    {% endfor %}
                </div>
                <div class="input-row">
                    {% for html_name, display_name in fields[2:] %}
                    <div class="input-group">
                        <label for="{{ html_name }}">{{ display_name }}</label>
                        <input type="text" 
                               id="{{ html_name }}" 
                               name="{{ html_name }}" 
                               value="{{ request.form.get(html_name, '') }}"
                               placeholder="Enter value in cm"
                               required>
                        <p class="hint-text">Range: {{ '{:.1f}'.format(ranges[html_name][0]) }} - {{ '{:.1f}'.format(ranges[html_name][1]) }} cm</p>
                    </div>
                    {% endfor %}
                </div>
                <button type="submit" class="btn-predict">üîÆ Predict Species</button>
            </form>
        </div>
        
        {% if warning %}
        <div class="warning-box">
            <strong>‚ö†Ô∏è Warning:</strong> {{ warning }}
        </div>
        {% endif %}
        
        {% if prediction is not none %}
        <div class="result-container">
            <!-- Flower Image or SVG Fallback -->
            <div class="flower-image">
                {% if flower_images and label in flower_images %}
                    <img src="{{ flower_images[label] }}" alt="{{ label }} flower" onerror="this.style.display='none'; this.parentElement.classList.add('svg-fallback');">
                {% endif %}
                
                <!-- SVG Fallback (will show if image fails to load) -->
                <div class="svg-container">
                    {% if label == 'setosa' %}
                    <svg class="flower-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <radialGradient id="setosaGradient">
                                <stop offset="0%" style="stop-color:#ff6b9d;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#feca57;stop-opacity:1" />
                            </radialGradient>
                        </defs>
                        <g transform="translate(100,100)">
                            <ellipse cx="0" cy="-30" rx="20" ry="40" fill="url(#setosaGradient)" transform="rotate(0)" opacity="0.9"/>
                            <ellipse cx="0" cy="-30" rx="20" ry="40" fill="url(#setosaGradient)" transform="rotate(72)" opacity="0.9"/>
                            <ellipse cx="0" cy="-30" rx="20" ry="40" fill="url(#setosaGradient)" transform="rotate(144)" opacity="0.9"/>
                            <ellipse cx="0" cy="-30" rx="20" ry="40" fill="url(#setosaGradient)" transform="rotate(216)" opacity="0.9"/>
                            <ellipse cx="0" cy="-30" rx="20" ry="40" fill="url(#setosaGradient)" transform="rotate(288)" opacity="0.9"/>
                            <circle cx="0" cy="0" r="15" fill="#ff6348"/>
                            <circle cx="0" cy="0" r="10" fill="#ff7979"/>
                        </g>
                    </svg>
                    {% elif label == 'versicolor' %}
                    <svg class="flower-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <radialGradient id="versicolorGradient">
                                <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
                            </radialGradient>
                        </defs>
                        <g transform="translate(100,100)">
                            <ellipse cx="0" cy="-35" rx="25" ry="45" fill="url(#versicolorGradient)" transform="rotate(0)"/>
                            <ellipse cx="0" cy="-35" rx="25" ry="45" fill="url(#versicolorGradient)" transform="rotate(60)"/>
                            <ellipse cx="0" cy="-35" rx="25" ry="45" fill="url(#versicolorGradient)" transform="rotate(120)"/>
                            <ellipse cx="0" cy="-35" rx="25" ry="45" fill="url(#versicolorGradient)" transform="rotate(180)"/>
                            <ellipse cx="0" cy="-35" rx="25" ry="45" fill="url(#versicolorGradient)" transform="rotate(240)"/>
                            <ellipse cx="0" cy="-35" rx="25" ry="45" fill="url(#versicolorGradient)" transform="rotate(300)"/>
                            <circle cx="0" cy="0" r="18" fill="#5f27cd"/>
                            <circle cx="0" cy="0" r="12" fill="#341f97"/>
                        </g>
                    </svg>
                    {% else %}
                    <svg class="flower-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <radialGradient id="virginicaGradient">
                                <stop offset="0%" style="stop-color:#a29bfe;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#6c5ce7;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#fd79a8;stop-opacity:1" />
                            </radialGradient>
                        </defs>
                        <g transform="translate(100,100)">
                            <ellipse cx="0" cy="-40" rx="30" ry="50" fill="url(#virginicaGradient)" transform="rotate(0)" opacity="0.9"/>
                            <ellipse cx="0" cy="-40" rx="30" ry="50" fill="url(#virginicaGradient)" transform="rotate(45)" opacity="0.9"/>
                            <ellipse cx="0" cy="-40" rx="30" ry="50" fill="url(#virginicaGradient)" transform="rotate(90)" opacity="0.9"/>
                            <ellipse cx="0" cy="-40" rx="30" ry="50" fill="url(#virginicaGradient)" transform="rotate(135)" opacity="0.9"/>
                            <ellipse cx="0" cy="-40" rx="30" ry="50" fill="url(#virginicaGradient)" transform="rotate(180)" opacity="0.9"/>
                            <ellipse cx="0" cy="-40" rx="30" ry="50" fill="url(#virginicaGradient)" transform="rotate(225)" opacity="0.9"/>
                            <ellipse cx="0" cy="-40" rx="30" ry="50" fill="url(#virginicaGradient)" transform="rotate(270)" opacity="0.9"/>
                            <ellipse cx="0" cy="-40" rx="30" ry="50" fill="url(#virginicaGradient)" transform="rotate(315)" opacity="0.9"/>
                            <circle cx="0" cy="0" r="20" fill="#6c5ce7"/>
                            <circle cx="0" cy="0" r="15" fill="#a29bfe"/>
                            <circle cx="0" cy="0" r="8" fill="#ffeaa7"/>
                        </g>
                    </svg>
                    {% endif %}
                </div>
            </div>
            
            <div class="prediction-header">
                <h2 class="prediction-title">Prediction Result</h2>
                <p class="prediction-label">{{ label|upper }}</p>
            </div>
            
            <div class="confidence-container">
                <h3 class="confidence-title">Confidence Scores</h3>
                {% for cls, conf in confidences.items() %}
                <div class="confidence-item">
                    <div class="confidence-label">
                        <span>{{ cls|capitalize }}</span>
                        <span>{{ '{:.1f}%'.format(conf*100) }}</span>
                    </div>
                    <div class="confidence-bar">
                        <div class="confidence-fill {{ cls }}-fill" style="width: {{ conf*100 }}%;">

                            <div class="confidence-fill {{ cls }}-fill" 
                                     style="width: {{ '{:.1f}'.format(conf*100) }}%;"
                            {% if conf > 0.15 %}
                                <span class="confidence-text">{{ '{:.1f}%'.format(conf*100) }}</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
</body>
</html>